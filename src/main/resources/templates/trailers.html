<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>

    <!-- Meta tags && title && icon -->
    <div th:replace="/fragments/template_basic_header :: base_header"></div>

    <!-- Bootstrap CSS (Temporally location)-->
    <div th:replace="/fragments/bootstrap_template :: bootstrap_css"></div>

    <!-- Customize css -->
    <link type="text/css" rel="stylesheet" href="/styles/css/customize__navbar.css">
    <link type="text/css" rel="stylesheet" href="/styles/css/customize__trailer-preview.css">

</head>
<body>

    <!-- Nav header -->
    <header th:replace="/fragments/navbar :: navbar_header"></header>

    <main class="container mt-4 mt-lg-5 overflow-hidden">
        <div class="row gy-3 gx-5">
            <!-- Filter -->
            <aside class="col-lg-3 text-light d-grid">

                <!-- Accordion -->
                <div class="accordion accordion-flush" id="accordionFlushFilter">

                    <!-- Header Filter -->
                    <div class="bg-secondary rounded">
                        <p class="h4 p-3 text-center" style="height: 100%;">Filter</p>
                    </div>

                    <!-- Genre Filter -->
                    <div>
                        <div th:replace="/fragments/filter :: filter_section( parent='accordionFlushFilter', id='flush-genres', 
                        idCollapse='flush-collapseGenres', title='Por GÃ©nero', object='genresList', 
                        getLabelMethod='getNameGenre', getIdMethod='getIdGenre')">
                    </div>

                    <!-- Audio Filter -->
                    <div>
                        <div th:replace="/fragments/filter :: filter_section( parent='accordionFlushFilter', id='flush-audio', 
                        idCollapse='flush-collpaseAudio', title='Por Audio', object='languagesList', 
                        getLabelMethod='getNameLanguage', getIdMethod='getIdLanguage')">
                    </div>

                    <!-- Subtitle Filter -->
                    <div>
                        <div th:replace="/fragments/filter :: filter_section( parent='accordionFlushFilter', id='flush-subtitle', 
                        idCollapse='flush-collapseSubtitle', title='Por Subtitulos', object='languagesList', 
                        getLabelMethod='getNameLanguage', getIdMethod='getIdLanguage')">
                    </div>
                </div>
            </aside>

            <!-- Trailers -->
            <div class="col-lg-9">
                <div class="row row-cols-2 row-cols-sm-3 row-cols-lg-4 row-cols-xxl-5 pt-1">

                    <!-- Trailers Divs-->
                    <div th:each="trailer : ${trailersList}" 
                        class="col px-3 py-1 c_link-video-container">

                        <a th:href="@{/app/trailer/view/{id}(id=${trailer.getId}) }"
                            th:title="${trailer.getTitle}" 
                            th:data-bs-content-id="${ 'popover' + trailer.getId}" 
                            tabindex="0" data-bs-toggle="popover" data-bs-placement="left" 
                            data-bs-trigger="hover focus">

                            <div class="position-relative overflow-hidden rounded-3">
                                <!-- Image -->
                                <img th:src="@{${ 'http://i.ytimg.com/vi/' + trailer.getId + '/mqdefault.jpg' }}" 
                                    th:alt="${ 'Imagen del trailer: ' + trailer.getTitle }" class="w-100 c_img-video">
                                <!-- Icons Language -->
                                <div th:if="${ trailer.getLanguage.getIdLanguage != '0' || trailer.getSubtitle.getIdLanguage != '0' }"
                                    class="position-absolute top-0 end-0 p-2 d-flex rounded-3 c_languageInfo">
                                    <!-- Audio Icon -->
                                    <div th:if="${ trailer.getLanguage.getIdLanguage != '0' }"
                                        class="d-flex">
                                        <img src="/resources/icons/volume__icon.svg" 
                                            alt="Icono de audio" class="me-1"> 
                                        <img th:src="${ trailer.getLanguage.getIconLanguage }" 
                                            th:alt="${ 'Icono de audio ' + trailer.getLanguage.getNameLanguage.toLowerCase() }" 
                                            style="height: 100%;">
                                    </div>
                                    <!-- Subtitle Icon -->
                                    <div th:if="${ trailer.getSubtitle.getIdLanguage != '0' }"
                                        class="d-flex ms-2">
                                        <img src="/resources/icons/subtitle__icon.svg" 
                                            alt="Icono de subtitulo" class="me-1"> 
                                        <img th:src="${ trailer.getSubtitle.getIconLanguage }"
                                            th:alt="${ 'Icono de subtitulos en ' + trailer.getSubtitle.getNameLanguage.toLowerCase() }" 
                                            style="height: 100%;">
                                    </div>
                                </div>
                            </div>
                            <p th:text="${ trailer.getTitle }"
                                class="text-truncate"></p>
                        </a>

                        <!-- Popover -->
                        <div th:id="${ 'popover' + trailer.getId}" class="d-none">
                            <div class="row justify-content-center px-1">
                                <div th:each="genre : ${ trailer.getMovie.getGenreList }"
                                    th:text="${ genre.getNameGenre }"
                                    class="col-auto bg-secondary text-light rounded-pill m-1"></div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            
        </div>
    </main>

    <!-- Footer -->
    <div th:replace="/fragments/footer :: basic_footer"></div>

    <!-- Bootstrap JS -->
    <div th:replace="/fragments/bootstrap_template :: bootstrap_js-basic"></div>

    <!-- Customm Js -->
    <script src="/utils/autoadjust_16-9__video-proportions.js"></script>
</body>
</html>